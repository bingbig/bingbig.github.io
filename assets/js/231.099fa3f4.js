(window.webpackJsonp=window.webpackJsonp||[]).push([[231],{249:function(s,t,n){"use strict";n.r(t);var a=n(0),e=Object(a.a)({},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"content"},[s._m(0),s._v(" "),n("blockquote",[n("p",[s._v("本文参考： "),n("a",{attrs:{href:"https://medium.com/@ssttehrani/containers-from-scratch-with-golang-5276576f9909",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://medium.com/@ssttehrani/containers-from-scratch-with-golang-5276576f9909"),n("OutboundLink")],1)])]),s._v(" "),s._m(1),s._v(" "),n("p",[s._v("我们来探索以下：")]),s._v(" "),s._m(2),s._m(3),s._v(" "),s._m(4),n("p",[s._v("这个数字意味着没有对这个主机进程没有内存限制。")]),s._v(" "),s._m(5),s._v(" "),n("p",[s._v("我们先看看没有cgroup限制的场景：")]),s._v(" "),s._m(6),n("p",[s._v("再看看有cgroup限制的例子：")]),s._v(" "),s._m(7),n("p",[s._v("因此我们知道了如何限制容器的资源，开始撸码！")]),s._v(" "),s._m(8),s._m(9),s._v(" "),s._m(10),n("p",[s._v("执行！")]),s._v(" "),s._m(11),n("p",[s._v("我们还可以看到程序创建的PID类型的cgroup文件：")]),s._v(" "),s._m(12)])},[function(){var s=this.$createElement,t=this._self._c||s;return t("h1",{attrs:{id:"命名空间go实现-cgroups"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#命名空间go实现-cgroups","aria-hidden":"true"}},[this._v("#")]),this._v(" 命名空间Go实现 - CGROUPS")])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[t("code",[this._v("Cgroups")]),this._v("是另外一种假的文件系统接口，它们看上去目录和文件，但是可以用来在用户空间和内核空间交换属性。简单的来说，cgroups可以限制一个容器使用的的资源。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("root@HiBing➜~ "),t("span",{attrs:{class:"token function"}},[this._v("ls")]),this._v(" /sys/fs/cgroup/\nblkio  cpu  cpuacct  cpu,cpuacct  cpuset  devices  freezer  hugetlb  memory  net_cls  net_cls,net_prio  net_prio  perf_event  pids  systemd\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br"),t("span",{staticClass:"line-number"},[this._v("2")]),t("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("我们可以看到，不同的目录表示不同的cgroups类型。可以在"),t("code",[this._v("memory")]),this._v("目录下看看"),t("code",[this._v("memory.limit_in_bytes")]),this._v("。")])},function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("root@HiBing➜~ "),t("span",{attrs:{class:"token function"}},[this._v("cat")]),this._v(" /sys/fs/cgroup/memory/memory.limit_in_bytes\n9223372036854771712\n")])]),this._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[this._v("1")]),t("br"),t("span",{staticClass:"line-number"},[this._v("2")]),t("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("在 "),t("code",[this._v("/sys/fs/cgroup/memory/")]),this._v(" 目录下有一个 "),t("code",[this._v("docker")]),this._v("目录，里面包含了Docker容器的内存类型的cgroups。")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{attrs:{class:"token comment"}},[s._v("## Run a Docker container")]),s._v("\nroot@host:~"),n("span",{attrs:{class:"token comment"}},[s._v("# docker run —name alpine —rm -it alpine:latest /bin/sh")]),s._v("\n"),n("span",{attrs:{class:"token comment"}},[s._v("## Retreving container ID")]),s._v("\nroot@host:~"),n("span",{attrs:{class:"token comment"}},[s._v("# docker container inspect alpine -f {{.ID}}")]),s._v("\n797257f234a5df64518bd470bd937a0d19f7b49cf3ad84c86ac0bb03fe34ebea\n"),n("span",{attrs:{class:"token comment"}},[s._v("## Check for cgroups limitation")]),s._v("\nroot@host:~"),n("span",{attrs:{class:"token comment"}},[s._v("# cat \\")]),s._v("\n/sys/fs/cgroup/memory/docker/797257f234a5df64518bd470bd937a0d19f7b49cf3ad84c86ac0bb03fe34ebea/memory.limit_in_bytes\n9223372036854771712\n"),n("span",{attrs:{class:"token comment"}},[s._v("## There is no limitation on this container processes")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("root@host:~"),n("span",{attrs:{class:"token comment"}},[s._v("# docker run —name alpine —rm -it —memory 50M alpine:latest /bin/sh")]),s._v("\n"),n("span",{attrs:{class:"token comment"}},[s._v("## Retreving container ID")]),s._v("\nroot@host:~"),n("span",{attrs:{class:"token comment"}},[s._v("# docker container inspect alpine -f {{.ID}}")]),s._v("\nbd8f7b86aca0ddcca61a562b43349a067e8c7eb5ec62fd854cd1b2e009006037\n"),n("span",{attrs:{class:"token comment"}},[s._v("## Check for cgroups limitation")]),s._v("\nroot@host:~"),n("span",{attrs:{class:"token comment"}},[s._v("# cat \\")]),s._v("\n/sys/fs/cgroup/memory/docker/bd8f7b86aca0ddcca61a562b43349a067e8c7eb5ec62fd854cd1b2e009006037/memory.limit_in_bytes\n52428800\n"),n("span",{attrs:{class:"token comment"}},[s._v("## There is 50M memory limitation on this container processes")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-go line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-go"}},[n("code",[s._v("# Git repo"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" https"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{attrs:{class:"token operator"}},[s._v("/")]),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("github"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("bingbig"),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("container\n# Git tag"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("6.0")]),s._v("\n# Filename"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" container"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token keyword"}},[s._v("go")]),s._v("\n"),n("span",{attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),n("span",{attrs:{class:"token function"}},[s._v("set_cgroups")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\tcgroups "),n("span",{attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),n("span",{attrs:{class:"token string"}},[s._v('"/sys/fs/cgroup/"')]),s._v("\n\tpids "),n("span",{attrs:{class:"token operator"}},[s._v(":=")]),s._v(" filepath"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("Join")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cgroups"),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token string"}},[s._v('"pids"')]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tos"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("Mkdir")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filepath"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("Join")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pids"),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token string"}},[s._v('"ourContainer"')]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("0755")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\tioutil"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("WriteFile")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filepath"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("Join")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pids"),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token string"}},[s._v('"ourContainer/pids.max"')]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{attrs:{class:"token function"}},[s._v("byte")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v('"10"')]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("0700")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{attrs:{class:"token comment"}},[s._v("//up here we limit the number of child processes to 10")]),s._v("\n\n\tioutil"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("WriteFile")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filepath"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("Join")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pids"),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token string"}},[s._v('"ourContainer/notify_on_release"')]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{attrs:{class:"token function"}},[s._v("byte")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v('"1"')]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("0700")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\tioutil"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("WriteFile")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filepath"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("Join")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pids"),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token string"}},[s._v('"ourContainer/cgroup.procs"')]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{attrs:{class:"token function"}},[s._v("byte")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strconv"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("Itoa")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("os"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("Getpid")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("0700")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{attrs:{class:"token comment"}},[s._v("// up here we write container PIDs to cgroup.procs")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])])},function(){var s=this.$createElement,t=this._self._c||s;return t("p",[this._v("在初始化中调用"),t("code",[this._v("set_cgroups")]),this._v("。")])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-go line-numbers-mode"},[n("div",{staticClass:"highlight-lines"},[n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("br"),n("div",{staticClass:"highlighted"},[s._v(" ")]),n("br"),n("br"),n("br"),n("br")]),n("pre",{pre:!0,attrs:{class:"language-go"}},[n("code",[s._v("# Git repo"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" https"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{attrs:{class:"token operator"}},[s._v("/")]),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("github"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("bingbig"),n("span",{attrs:{class:"token operator"}},[s._v("/")]),s._v("container\n# Git tag"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{attrs:{class:"token number"}},[s._v("6.0")]),s._v("\n# Filename"),n("span",{attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" container"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token keyword"}},[s._v("go")]),s._v("\n"),n("span",{attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),n("span",{attrs:{class:"token function"}},[s._v("nsInitialisation")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\tfmt"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("Printf")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v('"\\n>> namespace setup code goes here <<\\n\\n"')]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\t"),n("span",{attrs:{class:"token function"}},[s._v("setMount")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v('"/root/containerFS"')]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\t"),n("span",{attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err "),n("span",{attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),n("span",{attrs:{class:"token function"}},[s._v("waitForNetwork")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" err "),n("span",{attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\tfmt"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("Printf")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v('"Error waiting for network - %s\\n"')]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err"),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\tos"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("Exit")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token number"}},[s._v("1")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\t"),n("span",{attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err "),n("span",{attrs:{class:"token operator"}},[s._v(":=")]),s._v(" syscall"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("Sethostname")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{attrs:{class:"token function"}},[s._v("byte")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v('"container"')]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" err "),n("span",{attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),n("span",{attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\tfmt"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("Printf")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token string"}},[s._v('"Error setting hostname - %s\\n"')]),n("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err"),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\tos"),n("span",{attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{attrs:{class:"token function"}},[s._v("Exit")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token number"}},[s._v("1")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\t"),n("span",{attrs:{class:"token function"}},[s._v("set_cgroups")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\t"),n("span",{attrs:{class:"token function"}},[s._v("nsRun")]),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{attrs:{class:"token comment"}},[s._v("# Git repo: https://github.com/bingbig/container")]),s._v("\n"),n("span",{attrs:{class:"token comment"}},[s._v("# Git tag: 6.0")]),s._v("\n"),n("span",{attrs:{class:"token comment"}},[s._v("# Filename: container.go")]),s._v("\nliub@HiBing➜container git:"),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("master"),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ✗ go build\nliub@HiBing➜container git:"),n("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("master"),n("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ✗ ./container run /bin/sh\n\n"),n("span",{attrs:{class:"token operator"}},[s._v(">>")]),s._v(" namespace setup code goes here "),n("span",{attrs:{class:"token operator"}},[s._v("<<")]),s._v("\n\n-"),n("span",{attrs:{class:"token punctuation"}},[s._v("[")]),s._v("container"),n("span",{attrs:{class:"token punctuation"}},[s._v("]")]),s._v("- "),n("span",{attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])])},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("root@host:~"),n("span",{attrs:{class:"token comment"}},[s._v("# cat /sys/fs/cgroup/pids/ourContainer/pids.max")]),s._v("\n10\nroot@host:~"),n("span",{attrs:{class:"token comment"}},[s._v("# cat /sys/fs/cgroup/pids/ourContainer/cgroup.procs")]),s._v("\n11222\n11225\nroot@host:~"),n("span",{attrs:{class:"token comment"}},[s._v("# ps -aux | grep “/proc/self/exe ns /bin/bash”")]),s._v("\nroot 11222 /proc/self/exe ns /bin/sh\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])])}],!1,null,null,null);e.options.__file="namespaces_in_go_cgroups.md";t.default=e.exports}}]);