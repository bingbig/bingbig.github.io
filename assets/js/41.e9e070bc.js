(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{387:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),a("p",[t._v("最近要封装GA4GH的API接口，先提前复习一下相关的知识。")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),a("p",[a("code",[t._v("XMLHttpRequest")]),t._v("一开始只是微软浏览器提供的一个接口，后来各大浏览器纷纷效仿也提供了这个接口，再后来W3C对它进行了标准化，提出了"),a("a",{attrs:{href:"https://www.w3.org/TR/XMLHttpRequest/",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("XMLHttpRequest")]),t._v("标准"),a("OutboundLink")],1),t._v("。"),a("code",[t._v("XMLHttpRequest")]),t._v("标准又分为"),a("code",[t._v("Level 1")]),t._v("和"),a("code",[t._v("Level 2")]),t._v("。\n"),a("code",[t._v("XMLHttpRequest Level 1")]),t._v("主要存在以下缺点：")]),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),a("p",[t._v("尽管名为 XMLHttpRequest，它并不限于和 XML 文档一起使用：它可以接收任何形式的文本文档。")]),t._v(" "),a("p",[t._v("XMLHttpRequest 对象是名为 "),a("a",{attrs:{href:"http://www.w3school.com.cn/ajax/index.asp",target:"_blank",rel:"noopener noreferrer"}},[t._v("AJAX"),a("OutboundLink")],1),t._v(" 的 Web 应用程序架构的一项关键功能。目前，大部分浏览器对它都有很好的支持。")]),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),a("p",[t._v("从HTTP请求的状态从0到4，如下表所示：")]),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),a("p",[t._v("不包括头部。")]),t._v(" "),t._m(13),t._m(14),t._v(" "),a("p",[t._v("将请求的响应解析为Document对象返回。")]),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._v(" "),t._m(23),t._v(" "),t._m(24),a("p",[t._v("从代码中我们可以看出：")]),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),a("p",[t._v("每次 readyState 属性改变的时候调用的事件句柄函数。当 readyState 为 3 时，它也可能调用多次。")]),t._v(" "),t._m(28),t._v(" "),t._m(29),t._v(" "),t._m(30),t._v(" "),t._m(31),t._v(" "),a("p",[t._v("当请求一切正常时，相关的事件触发顺序如下：")]),t._v(" "),t._m(32),t._v(" "),t._m(33),t._v(" "),t._m(34),t._v(" "),a("p",[t._v("取消当前响应，关闭连接并结束任何未决的网络活动。")]),t._v(" "),t._m(35),t._v(" "),a("p",[t._v("把HTTP响应头部作为未解析的字符串返回。")]),t._v(" "),t._m(36),t._v(" "),a("p",[t._v("返回指定HTTP响应头的值。")]),t._v(" "),t._m(37),t._v(" "),a("p",[t._v("初始化HTTP请求参数，但是并不发送请求。")]),t._v(" "),t._m(38),t._m(39),t._v(" "),t._m(40),t._v(" "),t._m(41),t._v(" "),a("p",[t._v("除了保存供 send() 方法使用的请求参数，以及重置 XMLHttpRequest 对象以便复用，open() 方法没有其他的行为。要特别注意，==当这个方法调用的时候，通常不会打开一个到 Web 服务器的网络连接==。")]),t._v(" "),t._m(42),t._v(" "),a("p",[t._v("发送HTTP请求，使用传递给open()方法的参数，以及传递给该方法的可选请求体。")]),t._v(" "),t._m(43),a("p",[t._v("如果之前没有调用 open()，或者更具体地说，如果 readyState 不是 1，send() 抛出一个异常。否则，它发送一个 HTTP 请求，该请求由以下几部分组成：")]),t._v(" "),t._m(44),t._v(" "),t._m(45),t._v(" "),a("p",[t._v("向一个==打开但未发送==的请求设置或者添加一个HTTP请求。")]),t._v(" "),t._m(46),t._m(47),t._v(" "),t._m(48),t._v(" "),a("p",[t._v("这个方法只有当 readyState 为 1 的时候才能调用，例如，在调用了 open() 之后，但在调用 send() 之前。")]),t._v(" "),a("p",[t._v("有些请求头部由 XMLHttpRequest 自动设置而不是由这个方法设置，以符合 HTTP 协议。这包括如下和代理相关的头部：")]),t._v(" "),t._m(49),t._v(" "),t._m(50),t._v(" "),t._m(51),t._m(52),t._v(" "),t._m(53),t._v(" "),a("p",[t._v("AJAX涉及异步JavaScript和XML，是一种用来更好更快和更加互动的web技术，它的实现，需要XML，HTML，CSS和JS。")]),t._v(" "),a("p",[t._v("AJAX基于以下标准：")]),t._v(" "),t._m(54),t._v(" "),t._m(55),t._m(56),t._v(" "),t._m(57),t._m(58),t._v(" "),t._m(59),t._m(60),t._v(" "),t._m(61),t._v(" "),t._m(62),t._v(" "),t._m(63),a("p",[t._v("最后给点扩展学习资料，如果你：")]),t._v(" "),a("ul",[a("li",[t._v("想真正搞懂"),a("code",[t._v("XMLHttpRequest")]),t._v("，最靠谱的方法还是看 "),a("a",{attrs:{href:"https://www.w3.org/TR/XMLHttpRequest/",target:"_blank",rel:"noopener noreferrer"}},[t._v("W3C的xhr 标准"),a("OutboundLink")],1),t._v(";")]),t._v(" "),a("li",[t._v("想结合代码学习如何用"),a("code",[t._v("XMLHttpRequest")]),t._v("发各种类型的数据，可以参考"),a("a",{attrs:{href:"http://www.html5rocks.com/zh/tutorials/file/xhr2/",target:"_blank",rel:"noopener noreferrer"}},[t._v("html5rocks上的这篇文章"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("想粗略的了解"),a("code",[t._v("XMLHttpRequest")]),t._v("的基本使用，可以参考"),a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN的XMLHttpRequest介绍"),a("OutboundLink")],1),t._v("；")]),t._v(" "),a("li",[t._v("想了解"),a("code",[t._v("XMLHttpRequest")]),t._v(" 的发展历程，可以参考"),a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2012/09/xmlhttprequest_level_2.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("阮老师的文章"),a("OutboundLink")],1),t._v("；")]),t._v(" "),a("li",[t._v("想了解"),a("code",[t._v("Ajax")]),t._v("的基本介绍，可以参考"),a("a",{attrs:{href:"http://www.tutorialspoint.com/ajax/index.htm",target:"_blank",rel:"noopener noreferrer"}},[t._v("AJAX Tutorial"),a("OutboundLink")],1),t._v(";")]),t._v(" "),a("li",[t._v("想了解跨域请求，则可以参考"),a("a",{attrs:{href:"https://www.w3.org/TR/cors/",target:"_blank",rel:"noopener noreferrer"}},[t._v("W3C的 cors 标准"),a("OutboundLink")],1),t._v(";")]),t._v(" "),a("li",[t._v("想了解"),a("code",[t._v("http")]),t._v("协议，则可以参考"),a("a",{attrs:{href:"http://www.tutorialspoint.com/http/http_header_fields.htm",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTTP Tutorial"),a("OutboundLink")],1),t._v(";")])])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"xml-dom-xmlhttprequest对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#xml-dom-xmlhttprequest对象","aria-hidden":"true"}},[this._v("#")]),this._v(" XML DOM - XMLHttpRequest对象")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("参考")]),this._v(" "),s("ol",[s("li",[this._v("http://www.w3school.com.cn/xmldom/dom_http.asp")]),this._v(" "),s("li",[this._v("https://segmentfault.com/a/1190000004322487")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"xmlhttprequest的发展历程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#xmlhttprequest的发展历程","aria-hidden":"true"}},[this._v("#")]),this._v(" XMLHttpRequest的发展历程")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("受同源策略的限制，不能发送跨域请求；")]),this._v(" "),s("li",[this._v("不能发送二进制文件（如图片、视频、音频等），只能发送纯文本数据；")]),this._v(" "),s("li",[this._v("在发送和获取数据的过程中，无法实时获取进度信息，只能判断是否完成；")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("那么"),s("code",[this._v("Level 2")]),this._v("对"),s("code",[this._v("Level 1")]),this._v(" 进行了改进，"),s("code",[this._v("XMLHttpRequest Level 2")]),this._v("中新增了以下功能：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("可以发送跨域请求，在服务端允许的情况下；")]),t._v(" "),a("li",[t._v("支持发送和接收二进制数据；")]),t._v(" "),a("li",[t._v("新增formData对象，支持发送表单数据；")]),t._v(" "),a("li",[t._v("发送和获取数据时，可以获取进度信息；")]),t._v(" "),a("li",[t._v("可以设置请求的超时时间；")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"xmlhttprequest对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#xmlhttprequest对象","aria-hidden":"true"}},[this._v("#")]),this._v(" XMLHttpRequest对象")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[a("code",[t._v("XMLHttpRequest")]),t._v("对象提供了对 HTTP 协议的完全的访问，包括做出 "),a("code",[t._v("POST")]),t._v("和 "),a("code",[t._v("HEAD")]),t._v("请求以及普通的 "),a("code",[t._v("GET")]),t._v("请求的能力。XMLHttpRequest 可以同步或异步地返回 Web 服务器的响应，并且能够以文本或者一个 DOM 文档的形式返回内容。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#属性","aria-hidden":"true"}},[this._v("#")]),this._v(" 属性")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_1-http请求的状态readystate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-http请求的状态readystate","aria-hidden":"true"}},[this._v("#")]),this._v(" 1. HTTP请求的状态"),s("code",[this._v("readyState")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("状态")]),t._v(" "),a("th",[t._v("名称")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("0")]),t._v(" "),a("td",[t._v("Uninitialized")]),t._v(" "),a("td",[t._v("初始化状态。XMLHttpRequest 对象已创建或已被 abort() 方法重置。")])]),t._v(" "),a("tr",[a("td",[t._v("1")]),t._v(" "),a("td",[t._v("Open")]),t._v(" "),a("td",[t._v("open() 方法已调用，但是 send() 方法未调用。请求还没有被发送。")])]),t._v(" "),a("tr",[a("td",[t._v("2")]),t._v(" "),a("td",[t._v("Sent")]),t._v(" "),a("td",[t._v("Send() 方法已调用，HTTP 请求已发送到 Web 服务器。未接收到响应。")])]),t._v(" "),a("tr",[a("td",[t._v("3")]),t._v(" "),a("td",[t._v("Receiving")]),t._v(" "),a("td",[t._v("所有响应头部都已经接收到。响应体开始接收但未完成。")])]),t._v(" "),a("tr",[a("td",[t._v("4")]),t._v(" "),a("td",[t._v("Loaded")]),t._v(" "),a("td",[t._v("HTTP 响应已经完全接收。")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("状态值不会递减，除非请求中调用了"),a("code",[t._v("abort()")]),t._v(" 和"),a("code",[t._v("open()")]),t._v("方法。")]),t._v(" "),a("li",[t._v("状态改变会触发事件"),a("code",[t._v("onreadystatechange")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_2-响应体responsetext"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-响应体responsetext","aria-hidden":"true"}},[this._v("#")]),this._v(" 2. 响应体responseText")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("readyState < 3: 空字符串\n\nreadyState = 3: 部分相应数据\n\nreadyState = 4: 完整响应体\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br"),s("span",{staticClass:"line-number"},[this._v("2")]),s("br"),s("span",{staticClass:"line-number"},[this._v("3")]),s("br"),s("span",{staticClass:"line-number"},[this._v("4")]),s("br"),s("span",{staticClass:"line-number"},[this._v("5")]),s("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_3-reponsexml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-reponsexml","aria-hidden":"true"}},[this._v("#")]),this._v(" 3. reponseXML")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_4-status"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-status","aria-hidden":"true"}},[this._v("#")]),this._v(" 4. status")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("HTTP状态码")]),this._v("， 200表示成功，404表示没有找到，当"),s("code",[this._v("readyState < 3")]),this._v("时读取这一属性会报错。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_5-statustext"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-statustext","aria-hidden":"true"}},[this._v("#")]),this._v(" 5. statusText")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("当statu是200的时候它是“OK”，当status是404时它是“NOT FOUND”。同样，当"),s("code",[this._v("readyState < 3")]),this._v("时读取这一属性会报错。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"_6-responsetype"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-responsetype","aria-hidden":"true"}},[this._v("#")]),this._v(" 6. responseType")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("responseType")]),this._v("是"),s("code",[this._v("xhr level 2")]),this._v("新增的属性，用来指定"),s("code",[this._v("xhr.response")]),this._v("的数据类型，目前还存在些兼容性问题.")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("值")]),t._v(" "),a("th",[t._v("数据类型")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v('""')])]),t._v(" "),a("td",[a("code",[t._v("String")]),t._v("字符串")]),t._v(" "),a("td",[t._v("默认值(在不设置"),a("code",[t._v("responseType")]),t._v("时)")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v('"text"')])]),t._v(" "),a("td",[a("code",[t._v("String")]),t._v("字符串")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[a("code",[t._v('"document"')])]),t._v(" "),a("td",[a("code",[t._v("Document")]),t._v("对象")]),t._v(" "),a("td",[t._v("希望返回 "),a("code",[t._v("XML")]),t._v(" 格式数据时使用")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v('"json"')])]),t._v(" "),a("td",[a("code",[t._v("javascript")]),t._v(" 对象")]),t._v(" "),a("td",[t._v("存在兼容性问题，IE10/IE11不支持")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v('"blob"')])]),t._v(" "),a("td",[a("code",[t._v("Blob")]),t._v("对象")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[a("code",[t._v('"arrayBuffer"')])]),t._v(" "),a("td",[a("code",[t._v("ArrayBuffer")]),t._v("对象")]),t._v(" "),a("td")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件","aria-hidden":"true"}},[this._v("#")]),this._v(" 事件")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("xhr")]),this._v("相关事件有很多，有时记起来还挺容易混乱。下面是"),s("code",[this._v("XMLHttpRequest")]),this._v("的部分实现代码：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("interface XMLHttpRequestEventTarget : EventTarget {\n  // event handlers\n  attribute EventHandler onloadstart;\n  attribute EventHandler onprogress;\n  attribute EventHandler onabort;\n  attribute EventHandler onerror;\n  attribute EventHandler onload;\n  attribute EventHandler ontimeout;\n  attribute EventHandler onloadend;\n};\n\ninterface XMLHttpRequestUpload : XMLHttpRequestEventTarget {\n\n};\n\ninterface XMLHttpRequest : XMLHttpRequestEventTarget {\n  // event handler\n  attribute EventHandler onreadystatechange;\n  readonly attribute XMLHttpRequestUpload upload;\n};\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ol",[a("li",[a("code",[t._v("XMLHttpRequestEventTarget")]),t._v("接口定义了7个事件：\n"),a("ul",[a("li",[a("code",[t._v("onloadstart")])]),t._v(" "),a("li",[a("code",[t._v("onprogress")])]),t._v(" "),a("li",[a("code",[t._v("onabort")])]),t._v(" "),a("li",[a("code",[t._v("ontimeout")])]),t._v(" "),a("li",[a("code",[t._v("onerror")])]),t._v(" "),a("li",[a("code",[t._v("onload")])]),t._v(" "),a("li",[a("code",[t._v("onloadend")])])])]),t._v(" "),a("li",[t._v("每一个"),a("code",[t._v("XMLHttpRequest")]),t._v("里面都有一个"),a("code",[t._v("upload")]),t._v("属性，而"),a("code",[t._v("upload")]),t._v("是一个"),a("code",[t._v("XMLHttpRequestUpload")]),t._v("对象")]),t._v(" "),a("li",[a("code",[t._v("XMLHttpRequest")]),t._v("和"),a("code",[t._v("XMLHttpRequestUpload")]),t._v("都继承了同一个"),a("code",[t._v("XMLHttpRequestEventTarget")]),t._v("接口，所以"),a("code",[t._v("xhr")]),t._v("和"),a("code",[t._v("xhr.upload")]),t._v("都有第一条列举的7个事件")]),t._v(" "),a("li",[a("code",[t._v("onreadystatechange")]),t._v("是"),a("code",[t._v("XMLHttpRequest")]),t._v("独有的事件")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("所以这么一看就很清晰了：\n"),a("code",[t._v("xhr")]),t._v("一共有8个相关事件：7个"),a("code",[t._v("XMLHttpRequestEventTarget")]),t._v("事件+1个独有的"),a("code",[t._v("onreadystatechange")]),t._v("事件；而"),a("code",[t._v("xhr.upload")]),t._v("只有7个"),a("code",[t._v("XMLHttpRequestEventTarget")]),t._v("事件。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"onreadystatechange"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#onreadystatechange","aria-hidden":"true"}},[this._v("#")]),this._v(" onreadystatechange")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"事件触发条件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件触发条件","aria-hidden":"true"}},[this._v("#")]),this._v(" 事件触发条件")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("下面是一张"),s("code",[this._v("xhr")]),this._v("相关事件触发条件表，其中最需要注意的是 "),s("code",[this._v("onerror")]),this._v(" 事件的触发条件。")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("事件")]),t._v(" "),a("th",[t._v("触发条件")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v("onreadystatechange")])]),t._v(" "),a("td",[t._v("每当"),a("code",[t._v("xhr.readyState")]),t._v("改变时触发；但"),a("code",[t._v("xhr.readyState")]),t._v("由非"),a("code",[t._v("0")]),t._v("值变为"),a("code",[t._v("0")]),t._v("时不触发。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("onloadstart")])]),t._v(" "),a("td",[t._v("调用"),a("code",[t._v("xhr.send()")]),t._v("方法后立即触发，若"),a("code",[t._v("xhr.send()")]),t._v("未被调用则不会触发此事件。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("onprogress")])]),t._v(" "),a("td",[a("code",[t._v("xhr.upload.onprogress")]),t._v("在上传阶段(即"),a("code",[t._v("xhr.send()")]),t._v("之后，"),a("code",[t._v("xhr.readystate=2")]),t._v("之前)触发，每50ms触发一次；"),a("code",[t._v("xhr.onprogress")]),t._v("在下载阶段（即"),a("code",[t._v("xhr.readystate=3")]),t._v("时）触发，每50ms触发一次。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("onload")])]),t._v(" "),a("td",[t._v("当请求成功完成时触发，此时"),a("code",[t._v("xhr.readystate=4")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("onloadend")])]),t._v(" "),a("td",[t._v("当请求结束（包括请求成功和请求失败）时触发")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("onabort")])]),t._v(" "),a("td",[t._v("当调用"),a("code",[t._v("xhr.abort()")]),t._v("后触发")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("ontimeout")])]),t._v(" "),a("td",[a("code",[t._v("xhr.timeout")]),t._v("不等于0，由请求开始即"),a("code",[t._v("onloadstart")]),t._v("开始算起，当到达"),a("code",[t._v("xhr.timeout")]),t._v("所设置时间请求还未结束即"),a("code",[t._v("onloadend")]),t._v("，则触发此事件。")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("onerror")])]),t._v(" "),a("td",[t._v("在请求过程中，若发生"),a("code",[t._v("Network error")]),t._v("则会触发此事件（若发生"),a("code",[t._v("Network error")]),t._v("时，上传还没有结束，则会先触发"),a("code",[t._v("xhr.upload.onerror")]),t._v("，再触发"),a("code",[t._v("xhr.onerror")]),t._v("；若发生"),a("code",[t._v("Network error")]),t._v("时，上传已经结束，则只会触发"),a("code",[t._v("xhr.onerror")]),t._v("）。"),a("strong",[t._v("注意")]),t._v("，只有发生了网络层级别的异常才会触发此事件，对于应用层级别的异常，如响应返回的"),a("code",[t._v("xhr.statusCode")]),t._v("是"),a("code",[t._v("4xx")]),t._v("时，并不属于"),a("code",[t._v("Network error")]),t._v("，所以不会触发"),a("code",[t._v("onerror")]),t._v("事件，而是会触发"),a("code",[t._v("onload")]),t._v("事件。")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"事件触发顺序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#事件触发顺序","aria-hidden":"true"}},[this._v("#")]),this._v(" 事件触发顺序")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ol",[a("li",[t._v("触发"),a("code",[t._v("xhr.onreadystatechange")]),t._v("(之后每次"),a("code",[t._v("readyState")]),t._v("变化时，都会触发一次)")]),t._v(" "),a("li",[t._v("触发"),a("code",[t._v("xhr.onloadstart")]),t._v("\n//上传阶段开始：")]),t._v(" "),a("li",[t._v("触发"),a("code",[t._v("xhr.upload.onloadstart")])]),t._v(" "),a("li",[t._v("触发"),a("code",[t._v("xhr.upload.onprogress")])]),t._v(" "),a("li",[t._v("触发"),a("code",[t._v("xhr.upload.onload")])]),t._v(" "),a("li",[t._v("触发"),a("code",[t._v("xhr.upload.onloadend")]),t._v("\n//上传结束，下载阶段开始：")]),t._v(" "),a("li",[t._v("触发"),a("code",[t._v("xhr.onprogress")])]),t._v(" "),a("li",[t._v("触发"),a("code",[t._v("xhr.onload")])]),t._v(" "),a("li",[t._v("触发"),a("code",[t._v("xhr.onloadend")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方法","aria-hidden":"true"}},[this._v("#")]),this._v(" 方法")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"abort"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#abort","aria-hidden":"true"}},[this._v("#")]),this._v(" abort()")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"getallresponseheaders"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getallresponseheaders","aria-hidden":"true"}},[this._v("#")]),this._v(" getAllResponseHeaders()")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"getresponseheader"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getresponseheader","aria-hidden":"true"}},[this._v("#")]),this._v(" getResponseHeader()")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"open"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#open","aria-hidden":"true"}},[this._v("#")]),this._v(" open()")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token function"}},[t._v("open")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("method"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("async")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" username"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" password"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("method 参数是用于请求的 HTTP 方法。值包括 GET、POST 和 HEAD。")]),t._v(" "),a("li",[t._v("async 参数指示请求使用应该异步地执行。\n"),a("ul",[a("li",[t._v("如果这个参数是 false，请求是同步的，后续对 send() 的调用将阻塞，直到响应完全接收。")]),t._v(" "),a("li",[t._v("如果这个参数是 true 或省略，请求是异步的，且通常需要一个 "),a("code",[t._v("onreadystatechange")]),t._v(" 事件句柄。")])])]),t._v(" "),a("li",[t._v("username 和 password 参数是可选的，为 url 所需的授权提供认证资格。如果指定了，它们会覆盖 url 自己指定的任何资格。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#说明","aria-hidden":"true"}},[this._v("#")]),this._v(" 说明")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",[t._v("这个方法初始化请求参数以供 "),a("code",[t._v("send()")]),t._v("方法稍后使用。它把 "),a("code",[t._v("readyState")]),t._v("设置为 1，删除之前指定的所有请求头部，以及之前接收的所有响应头部，并且把 "),a("code",[t._v("responseText")]),t._v("、"),a("code",[t._v("responseXML")]),t._v("、"),a("code",[t._v("status")]),t._v(" 以及 "),a("code",[t._v("statusText")]),t._v(" 参数设置为它们的默认值。当 readyState 为 0 的时候（当 XMLHttpRequest 对象刚创建或者 abort() 方法调用后）以及当 readyState 为 4 时（已经接收响应时），调用这个方法是安全的。当针对任何其他状态调用的时候，open() 方法的行为是为指定的。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"send"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#send","aria-hidden":"true"}},[this._v("#")]),this._v(" send()")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token function"}},[this._v("send")]),s("span",{attrs:{class:"token punctuation"}},[this._v("(")]),this._v("body"),s("span",{attrs:{class:"token punctuation"}},[this._v(")")]),this._v("\n")])]),this._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[this._v("1")]),s("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("之前调用 open() 时指定的 HTTP 方法、URL 以及认证资格（如果有的话）。")]),this._v(" "),s("li",[this._v("之前调用 setRequestHeader() 时指定的请求头部（如果有的话）。")]),this._v(" "),s("li",[this._v("传递给这个方法的 "),s("em",[this._v("body")]),this._v(" 参数。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"setrequestheader"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setrequestheader","aria-hidden":"true"}},[this._v("#")]),this._v(" setRequestHeader()")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token function"}},[t._v("setRequestHeader")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("name 参数是要设置的头部的名称。这个参数不应该包括空白、冒号或换行。")]),this._v(" "),s("li",[this._v("value 参数是头部的值。这个参数不应该包括换行。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h5",{attrs:{id:"说明-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#说明-2","aria-hidden":"true"}},[this._v("#")]),this._v(" 说明")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("Host")]),t._v(" "),a("li",[t._v("Connection")]),t._v(" "),a("li",[t._v("Keep-Alive")]),t._v(" "),a("li",[t._v("Accept-charset")]),t._v(" "),a("li",[t._v("Accept-Encoding")]),t._v(" "),a("li",[t._v("If-Modified-Since")]),t._v(" "),a("li",[t._v("If-None-Match")]),t._v(" "),a("li",[t._v("If-Range")]),t._v(" "),a("li",[t._v("Range")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"timeout"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#timeout","aria-hidden":"true"}},[this._v("#")]),this._v(" timeout")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("xhr"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timeout "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("3000")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("单位：milliseconds 毫秒\n默认值："),s("code",[this._v("0")]),this._v("，即不设置超时")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"ajax和xmlhttprequest"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ajax和xmlhttprequest","aria-hidden":"true"}},[this._v("#")]),this._v(" AJAX和XMLHttpRequest")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("基于浏览器，用于展示HTML和CSS")]),this._v(" "),s("li",[this._v("数据保存为XML格式并从服务器获取")]),this._v(" "),s("li",[this._v("通过XMLHttpRequest后台异步获取数据到客户端浏览器")]),this._v(" "),s("li",[this._v("JavaScript无所不能")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("AJAX stands for Asynchronous JavaScript and XML. AJAX is a new technique for creating better, faster, and more interactive web applications with the help of XML, HTML, CSS, and Java Script.\n\nAJAX is based on the following open standards:\n\n1. Browser-based presentation using HTML and Cascading Style Sheets (CSS).\n2. Data is stored in XML format and fetched from the server.\n3. Behind-the-scenes data fetches using XMLHttpRequest objects in the browser.\n4. JavaScript to make everything happen.\n## From; http://www.tutorialspoint.com/ajax/what_is_ajax.htm\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"例子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#例子","aria-hidden":"true"}},[this._v("#")]),this._v(" 例子")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("sendAjax")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{attrs:{class:"token comment"}},[t._v("//构造表单数据")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" formData "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("FormData")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  formData"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("append")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'username'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'johndoe'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  formData"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("append")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'id'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("123456")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),a("span",{attrs:{class:"token comment"}},[t._v("//创建xhr对象 ")]),t._v("\n  "),a("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" xhr "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),a("span",{attrs:{class:"token comment"}},[t._v("//设置xhr请求的超时时间")]),t._v("\n  xhr"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timeout "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("3000")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),a("span",{attrs:{class:"token comment"}},[t._v("//设置响应返回的数据格式")]),t._v("\n  xhr"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseType "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"text"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),a("span",{attrs:{class:"token comment"}},[t._v("//创建一个 post 请求，采用异步")]),t._v("\n  xhr"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("open")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'POST'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'/server'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token boolean"}},[t._v("true")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),a("span",{attrs:{class:"token comment"}},[t._v("//注册相关事件回调处理函数")]),t._v("\n  xhr"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("onload")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n\t  "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("200")]),a("span",{attrs:{class:"token operator"}},[t._v("||")]),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("304")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t  "),a("span",{attrs:{class:"token function"}},[t._v("alert")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseText"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  xhr"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("ontimeout")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  xhr"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("onerror")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  xhr"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("upload"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("onprogress")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("...")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{attrs:{class:"token comment"}},[t._v("//发送数据")]),t._v("\n  xhr"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("send")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("formData"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"跟踪ajax"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#跟踪ajax","aria-hidden":"true"}},[this._v("#")]),this._v(" 跟踪AJAX")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("xhr"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function-variable function"}},[t._v("onreadystatechange")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("switch")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),a("span",{attrs:{class:"token constant"}},[t._v("OPENED")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("//do something")]),t._v("\n            "),a("span",{attrs:{class:"token keyword"}},[t._v("break")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("2")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),a("span",{attrs:{class:"token constant"}},[t._v("HEADERS_RECEIVED")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("//do something")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("break")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("3")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),a("span",{attrs:{class:"token constant"}},[t._v("LOADING")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("//do something")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("break")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("4")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),a("span",{attrs:{class:"token operator"}},[t._v("/")]),a("span",{attrs:{class:"token constant"}},[t._v("DONE")]),t._v("\n        "),a("span",{attrs:{class:"token comment"}},[t._v("//do something")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("break")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"获取上传、下载的速度"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取上传、下载的速度","aria-hidden":"true"}},[this._v("#")]),this._v(" 获取上传、下载的速度")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在上传或者下载比较大的文件时，实时显示当前的上传、下载进度是很普遍的产品需求。\n我们可以通过"),s("code",[this._v("onprogress")]),this._v("事件来实时显示进度，默认情况下这个事件每50ms触发一次。需要注意的是，上传过程和下载过程触发的是不同对象的"),s("code",[this._v("onprogress")]),this._v("事件：")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("上传触发的是"),a("code",[t._v("xhr.upload")]),t._v("对象的 "),a("code",[t._v("onprogress")]),t._v("事件")]),t._v(" "),a("li",[t._v("下载触发的是"),a("code",[t._v("xhr")]),t._v("对象的"),a("code",[t._v("onprogress")]),t._v("事件")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("updateProgress "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" xhr"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("upload"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onprogress"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("updateProgress")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lengthComputable"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" completedPercent "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" event"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("loaded "),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v(" event"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("total"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])])}],!1,null,null,null);n.options.__file="XMLHttpRequest.md";s.default=n.exports}}]);