(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{447:function(t,s,a){"use strict";a.r(s);var e=a(0),v=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"linux跟踪错误进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux跟踪错误进程","aria-hidden":"true"}},[t._v("#")]),t._v(" Linux跟踪错误进程")]),t._v(" "),a("p",[a("strong",[t._v("问题：在centos机器上 "),a("code",[t._v("ps aux")]),t._v(" 或者 "),a("code",[t._v("top －c")]),t._v(" 机器会卡死")])]),t._v(" "),a("p",[t._v("通过跟踪ps进程：")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token function"}},[t._v("strace")]),t._v(" -tt -T -v -o /root/strace-ps.log -s 1024 "),a("span",{attrs:{class:"token function"}},[t._v("ps")]),t._v(" -aux\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("打开strace-ps.log，查看最后，发现应该是6374的子进程有问题，因为"),a("strong",[t._v("无法读取进程信息")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("/proc/6374/cmdline\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("也无法打开，判断应该就是这个进程有问题。")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{attrs:{class:"token function"}},[t._v("strace")]),t._v("  "),a("span",{attrs:{class:"token function"}},[t._v("ls")]),t._v(" /proc/6374\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[a("code",[t._v("kill -9")]),t._v(" 此进程，一切恢复正常。")]),t._v(" "),a("h2",{attrs:{id:"补充"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#补充","aria-hidden":"true"}},[t._v("#")]),t._v(" 补充")]),t._v(" "),a("p",[t._v("strace可以跟踪到一个进程产生的系统调用，包含参数、返回值、执行消耗的时间。\n strace的常用的选项以及选项对应的含义如下：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("选项")]),t._v(" "),a("th",[t._v("含义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("-c")]),t._v(" "),a("td",[t._v("统计每一系统调用的所执行的时间,次数和出错的次数等")])]),t._v(" "),a("tr",[a("td",[t._v("-f")]),t._v(" "),a("td",[t._v("跟踪由fork调用所产生的子进程")])]),t._v(" "),a("tr",[a("td",[t._v("-t")]),t._v(" "),a("td",[t._v("在输出中的每一行前加上时间信息")])]),t._v(" "),a("tr",[a("td",[t._v("-tt")]),t._v(" "),a("td",[t._v("在输出中的每一行前加上时间信息（微妙级）")])]),t._v(" "),a("tr",[a("td",[t._v("-T")]),t._v(" "),a("td",[t._v("显示每一调用所耗的时间")])]),t._v(" "),a("tr",[a("td",[t._v("-e trace=set")]),t._v(" "),a("td",[t._v("只跟踪指定的系统调用。例如:-e")])]),t._v(" "),a("tr",[a("td",[t._v("-e trace=file")]),t._v(" "),a("td",[t._v("只跟踪有关文件操作的系统调用")])]),t._v(" "),a("tr",[a("td",[t._v("-e trace=process")]),t._v(" "),a("td",[t._v("只跟踪有关进程控制的系统调用")])]),t._v(" "),a("tr",[a("td",[t._v("-e trace=network")]),t._v(" "),a("td",[t._v("跟踪与网络有关的所有系统调用")])]),t._v(" "),a("tr",[a("td",[t._v("-e strace=signal")]),t._v(" "),a("td",[t._v("跟踪所有与系统信号有关的 系统调用")])]),t._v(" "),a("tr",[a("td",[t._v("-e trace=ipc")]),t._v(" "),a("td",[t._v("跟踪所有与进程通讯有关的系统调用")])]),t._v(" "),a("tr",[a("td",[t._v("-o filename")]),t._v(" "),a("td",[t._v("将strace的输出写入文件filename -p pid 跟踪指定的进程pid")])])])])])}],!1,null,null,null);v.options.__file="track_process.md";s.default=v.exports}}]);