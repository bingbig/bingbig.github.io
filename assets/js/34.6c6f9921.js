(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{366:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("div",{staticClass:"content"},[t("h1",{attrs:{id:"leetcode"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#leetcode","aria-hidden":"true"}},[s._v("#")]),s._v(" LeetCode")]),s._v(" "),t("p",[s._v("最近刷LeetCode DataBase，顺便把答案贴出来，供以后复习参考。")]),s._v(" "),t("blockquote",[t("p",[s._v("Contents")])]),s._v(" "),t("p",[s._v("[TOC]")]),s._v(" "),t("h2",{attrs:{id:"_175-combine-two-tables"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_175-combine-two-tables","aria-hidden":"true"}},[s._v("#")]),s._v(" 175. Combine Two Tables")]),s._v(" "),t("p",[s._v("Table: Person")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+-------------+--------+\n| Column Name | Type    |\n+-------------+--------+\n| PersonId    | int     |\n| FirstName   | varchar |\n| LastName    | varchar |\n+-------------+--------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("PersonId is the primary key column for this table.\nTable: Address")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+-------------+--------+\n| Column Name | Type    |\n+-------------+--------+\n| AddressId   | int     |\n| PersonId    | int     |\n| City        | varchar |\n| State       | varchar |\n+-------------+--------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("AddressId is the primary key column for this table.")]),s._v(" "),t("p",[s._v("Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for each of those people:")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("FirstName, LastName, City, State\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"solutions"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions","aria-hidden":"true"}},[s._v("#")]),s._v(" Solutions")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n\tFirstName"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" LastName"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" City"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" State\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n\tPerson "),t("span",{attrs:{class:"token keyword"}},[s._v("LEFT")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v(" Address\n"),t("span",{attrs:{class:"token keyword"}},[s._v("ON")]),s._v("\n\tPerson"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("PersonId "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" Address"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("PersonId\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"_176-second-highest-salary"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_176-second-highest-salary","aria-hidden":"true"}},[s._v("#")]),s._v(" 176. Second Highest Salary")]),s._v(" "),t("p",[s._v("Write a SQL query to get the second highest salary from the Employee table.")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+----+--------+\n| Id | Salary |\n+----+--------+\n| 1  | 100    |\n| 2  | 200    |\n| 3  | 300    |\n+----+--------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("For example, given the above Employee table, the query should return 200 as the second highest salary. If there is no second highest salary, then the query should return null.")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+---------------------+\n| SecondHighestSalary |\n+---------------------+\n| 200                 |\n+---------------------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h2",{attrs:{id:"solutions-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions-2","aria-hidden":"true"}},[s._v("#")]),s._v(" Solutions")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("DISTINCT")]),s._v("\n    Salary "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" SecondHighestSalary\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    Employee\n"),t("span",{attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" Salary "),t("span",{attrs:{class:"token keyword"}},[s._v("DESC")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("LIMIT")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("OFFSET")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    "),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("DISTINCT")]),s._v("\n            Salary\n        "),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n            Employee\n        "),t("span",{attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" Salary "),t("span",{attrs:{class:"token keyword"}},[s._v("DESC")]),s._v("\n        "),t("span",{attrs:{class:"token keyword"}},[s._v("LIMIT")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("OFFSET")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" SecondHighestSalary\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    IFNULL"),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n      "),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("DISTINCT")]),s._v(" Salary\n       "),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Employee\n       "),t("span",{attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" Salary "),t("span",{attrs:{class:"token keyword"}},[s._v("DESC")]),s._v("\n        "),t("span",{attrs:{class:"token keyword"}},[s._v("LIMIT")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("OFFSET")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{attrs:{class:"token boolean"}},[s._v("NULL")]),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" SecondHighestSalary\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"_177-nth-highest-salary"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_177-nth-highest-salary","aria-hidden":"true"}},[s._v("#")]),s._v(" 177. Nth Highest Salary")]),s._v(" "),t("p",[s._v("Write a SQL query to get the nth highest salary from the Employee table.")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+----+--------+\n| Id | Salary |\n+----+--------+\n| 1  | 100    |\n| 2  | 200    |\n| 3  | 300    |\n+----+--------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("For example, given the above Employee table, the nth highest salary where n = 2 is 200. If there is no nth highest salary, then the query should\nreturn null.")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+------------------------+\n| getNthHighestSalary(2) |\n+------------------------+\n| 200                    |\n+------------------------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h2",{attrs:{id:"solutions-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions-3","aria-hidden":"true"}},[s._v("#")]),s._v(" Solutions")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("FUNCTION")]),s._v(" getNthHighestSalary"),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("N "),t("span",{attrs:{class:"token keyword"}},[s._v("INT")]),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("RETURNS")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("INT")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("BEGIN")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("DECLARE")]),s._v(" M "),t("span",{attrs:{class:"token keyword"}},[s._v("INT")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" M "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" N "),t("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{attrs:{class:"token keyword"}},[s._v("RETURN")]),s._v(" "),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n      "),t("span",{attrs:{class:"token comment"}},[s._v("# Write your MySQL query statement below.")]),s._v("\n      "),t("span",{attrs:{class:"token keyword"}},[s._v("select")]),s._v(" IFNULL"),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("distinct")]),s._v(" Salary "),t("span",{attrs:{class:"token keyword"}},[s._v("from")]),s._v(" Employee "),t("span",{attrs:{class:"token keyword"}},[s._v("order")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("by")]),s._v(" Salary "),t("span",{attrs:{class:"token keyword"}},[s._v("desc")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("limit")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("offset")]),s._v(" M"),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{attrs:{class:"token boolean"}},[s._v("null")]),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("END")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"_180-consecutive-numbers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_180-consecutive-numbers","aria-hidden":"true"}},[s._v("#")]),s._v(" 180. Consecutive Numbers")]),s._v(" "),t("p",[s._v("Write a SQL query to find all numbers that appear at least three times consecutively.")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+----+-----+\n| Id | Num |\n+----+-----+\n| 1  |  1  |\n| 2  |  1  |\n| 3  |  1  |\n| 4  |  2  |\n| 5  |  1  |\n| 6  |  2  |\n| 7  |  2  |\n+----+-----+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("For example, given the above Logs table, 1 is the only number that appears consecutively for at least three times.")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+-----------------+\n| ConsecutiveNums |\n+-----------------+\n| 1               |\n+-----------------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h2",{attrs:{id:"solutions-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions-4","aria-hidden":"true"}},[s._v("#")]),s._v(" Solutions")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    Logs l1"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    Logs l2"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    Logs l3\n"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    l1"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" l2"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id "),t("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v("\n    "),t("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" l2"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" l3"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id "),t("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v("\n    "),t("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" l1"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Num "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" l2"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Num\n    "),t("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" l2"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Num "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" l3"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Num\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("DISTINCT")]),s._v("\n    l1"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Num "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" ConsecutiveNums\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    Logs l1"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    Logs l2"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    Logs l3\n"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    l1"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" l2"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id "),t("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v("\n    "),t("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" l2"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" l3"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id "),t("span",{attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v("\n    "),t("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" l1"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Num "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" l2"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Num\n    "),t("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" l2"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Num "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" l3"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Num\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"_181-employees-earning-more-than-their-managers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_181-employees-earning-more-than-their-managers","aria-hidden":"true"}},[s._v("#")]),s._v(" 181. Employees Earning More Than Their Managers")]),s._v(" "),t("p",[s._v("The Employee table holds all employees including their managers. Every employee has an Id, and there is also a column for the manager Id.")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+----+-------+--------+-----------+\n| Id | Name  | Salary | ManagerId |\n+----+-------+--------+-----------+\n| 1  | Joe   | 70000  | 3         |\n| 2  | Henry | 80000  | 4         |\n| 3  | Sam   | 60000  | NULL      |\n| 4  | Max   | 90000  | NULL      |\n+----+-------+--------+-----------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("Given the Employee table, write a SQL query that finds out employees who earn more than their managers. For the above table, Joe is the only employee who earns more than his manager.")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+----------+\n| Employee |\n+----------+\n| Joe      |\n+----------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h2",{attrs:{id:"solutions-5"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions-5","aria-hidden":"true"}},[s._v("#")]),s._v(" Solutions")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    a"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),t("span",{attrs:{class:"token string"}},[s._v("'Employee'")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    Employee "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" a"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    Employee "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" b\n"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    a"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ManagerId "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" b"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id\n        "),t("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" a"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Salary "),t("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" b"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Salary\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n     a"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("NAME "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" Employee\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Employee "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" a "),t("span",{attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v(" Employee "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" b\n     "),t("span",{attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" a"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ManagerId "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" b"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id\n     "),t("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" a"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Salary "),t("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" b"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Salary\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"_182-duplicate-emails"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_182-duplicate-emails","aria-hidden":"true"}},[s._v("#")]),s._v(" 182. Duplicate Emails")]),s._v(" "),t("p",[s._v("Write a SQL query to find all duplicate emails in a table named Person.")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+----+---------+\n| Id | Email   |\n+----+---------+\n| 1  | a@b.com |\n| 2  | c@d.com |\n| 3  | a@b.com |\n+----+---------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("For example, your query should return the following for the above table:")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+---------+\n| Email   |\n+---------+\n| a@b.com |\n+---------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("Note: All emails are in lowercase.\n​")]),s._v(" "),t("h2",{attrs:{id:"solutions-6"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions-6","aria-hidden":"true"}},[s._v("#")]),s._v(" Solutions")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n\tEmail\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n\t"),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\t\t"),t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" Email"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{attrs:{class:"token function"}},[s._v("count")]),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Email"),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" num\n\t\t"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Person\n\t\t"),t("span",{attrs:{class:"token keyword"}},[s._v("GROUP")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" Email\n\t"),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" statistic\n\t"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" num "),t("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n\tEmail\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n\tPerson\n"),t("span",{attrs:{class:"token keyword"}},[s._v("GROUP")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("BY")]),s._v("\n\tEmail\n"),t("span",{attrs:{class:"token keyword"}},[s._v("HAVING")]),s._v(" \n\t"),t("span",{attrs:{class:"token function"}},[s._v("count")]),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Email"),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"_183-customers-who-never-order"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_183-customers-who-never-order","aria-hidden":"true"}},[s._v("#")]),s._v(" 183. Customers Who Never Order")]),s._v(" "),t("p",[s._v("Suppose that a website contains two tables, the Customers table and the Orders table. Write a SQL query to find all customers who never order anything.\nTable: Customers.")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+----+-------+\n| Id | Name  |\n+----+-------+\n| 1  | Joe   |\n| 2  | Henry |\n| 3  | Sam   |\n| 4  | Max   |\n+----+-------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("Table: Orders.")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+----+------------+\n| Id | CustomerId |\n+----+------------+\n| 1  | 3          |\n| 2  | 1          |\n+----+------------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("Using the above tables as example, return the following:")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+-----------+\n| Customers |\n+-----------+\n| Henry     |\n| Max       |\n+-----------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"solutions-7"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions-7","aria-hidden":"true"}},[s._v("#")]),s._v(" Solutions")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n\tcustomers"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),t("span",{attrs:{class:"token string"}},[s._v("'Customers'")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n\tcustomers\n"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n\tcustomers"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id "),t("span",{attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v("IN")]),s._v("\n"),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" customerid "),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" orders\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    Name "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" Customers\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" \n    Customers \n"),t("span",{attrs:{class:"token keyword"}},[s._v("LEFT")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v(" \n    Orders \n"),t("span",{attrs:{class:"token keyword"}},[s._v("ON")]),s._v("\n    Customers"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" Orders"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CustomerId\n"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    Orders"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("CustomerId "),t("span",{attrs:{class:"token operator"}},[s._v("IS")]),s._v(" "),t("span",{attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"_184-department-highest-salary"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_184-department-highest-salary","aria-hidden":"true"}},[s._v("#")]),s._v(" 184. Department Highest Salary")]),s._v(" "),t("p",[s._v("The Employee table holds all employees. Every employee has an Id, a salary, and there is also a column for the department Id.")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token operator"}},[s._v("+")]),t("span",{attrs:{class:"token comment"}},[s._v("----+-------+--------+--------------+")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Id "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Name  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Salary "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" DepartmentId "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("+")]),t("span",{attrs:{class:"token comment"}},[s._v("----+-------+--------+--------------+")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Joe   "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("70000")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("2")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Henry "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("80000")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("2")]),s._v("            "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("3")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Sam   "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("60000")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("2")]),s._v("            "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("4")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Max   "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("90000")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v("            "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("+")]),t("span",{attrs:{class:"token comment"}},[s._v("----+-------+--------+--------------+")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("The Department table holds all departments of the company.")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token operator"}},[s._v("+")]),t("span",{attrs:{class:"token comment"}},[s._v("----+----------+")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Id "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Name     "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("+")]),t("span",{attrs:{class:"token comment"}},[s._v("----+----------+")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" IT       "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("2")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Sales    "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("+")]),t("span",{attrs:{class:"token comment"}},[s._v("----+----------+")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("Write a SQL query to find employees who have the highest salary in each of the departments. For the above tables, Max has the highest salary in the IT department and Henry has the highest salary in the Sales department.")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token operator"}},[s._v("+")]),t("span",{attrs:{class:"token comment"}},[s._v("------------+----------+--------+")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Department "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Employee "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Salary "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("+")]),t("span",{attrs:{class:"token comment"}},[s._v("------------+----------+--------+")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" IT         "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Max      "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("90000")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Sales      "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Henry    "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("80000")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("+")]),t("span",{attrs:{class:"token comment"}},[s._v("------------+----------+--------+")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"solutions-8"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions-8","aria-hidden":"true"}},[s._v("#")]),s._v(" Solutions")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    Department"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),t("span",{attrs:{class:"token string"}},[s._v("'Department'")]),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    Employee"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),t("span",{attrs:{class:"token string"}},[s._v("'Employee'")]),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    Salary\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    Employee\n        "),t("span",{attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v("\n    Department "),t("span",{attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" Employee"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DepartmentId "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" Department"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id\n"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    "),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Employee"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DepartmentId "),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Salary"),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v("IN")]),s._v("\n    "),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("   "),t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n            DepartmentId"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{attrs:{class:"token function"}},[s._v("MAX")]),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Salary"),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n            Employee\n        "),t("span",{attrs:{class:"token keyword"}},[s._v("GROUP")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" DepartmentId\n    "),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    D"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" Department"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" E"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Name "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" Employee"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" E"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Salary "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" Salary\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    Employee E"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Department D"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" DepartmentId"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{attrs:{class:"token function"}},[s._v("MAX")]),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Salary"),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" maxS "),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Employee "),t("span",{attrs:{class:"token keyword"}},[s._v("GROUP")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" DepartmentId"),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" T\n"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    E"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Salary "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" T"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("maxS "),t("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v("\n    E"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DepartmentId "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" T"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DepartmentId "),t("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v("\n    E"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("DepartmentId "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" D"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id\n "),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"_196-delete-duplicate-emails"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_196-delete-duplicate-emails","aria-hidden":"true"}},[s._v("#")]),s._v(" 196. Delete Duplicate Emails")]),s._v(" "),t("p",[s._v("Write a SQL query to delete all duplicate email entries in a table named Person, keeping only unique emails based on its smallest Id.")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token operator"}},[s._v("+")]),t("span",{attrs:{class:"token comment"}},[s._v("----+------------------+")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Id "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Email            "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("+")]),t("span",{attrs:{class:"token comment"}},[s._v("----+------------------+")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" john"),t("span",{attrs:{class:"token variable"}},[s._v("@example.com")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("2")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" bob"),t("span",{attrs:{class:"token variable"}},[s._v("@example.com")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("3")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" john"),t("span",{attrs:{class:"token variable"}},[s._v("@example.com")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("+")]),t("span",{attrs:{class:"token comment"}},[s._v("----+------------------+")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("Id is the primary key column for this table.\nFor example, after running your query, the above Person table should have the following rows:")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token operator"}},[s._v("+")]),t("span",{attrs:{class:"token comment"}},[s._v("----+------------------+")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Id "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" Email            "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("+")]),t("span",{attrs:{class:"token comment"}},[s._v("----+------------------+")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" john"),t("span",{attrs:{class:"token variable"}},[s._v("@example.com")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("2")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" bob"),t("span",{attrs:{class:"token variable"}},[s._v("@example.com")]),s._v("  "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{attrs:{class:"token operator"}},[s._v("+")]),t("span",{attrs:{class:"token comment"}},[s._v("----+------------------+")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"solutions-9"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions-9","aria-hidden":"true"}},[s._v("#")]),s._v(" Solutions")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" p1"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Person p1"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    Person p2\n"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    p1"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Email "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" p2"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Email "),t("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" p1"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id "),t("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" p2"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("DELETE")]),s._v(" p1 "),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" Person p1"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    Person p2\n"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    p1"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Email "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" p2"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Email "),t("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" p1"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id "),t("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" p2"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"_197-rising-temperature"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_197-rising-temperature","aria-hidden":"true"}},[s._v("#")]),s._v(" 197. Rising Temperature")]),s._v(" "),t("p",[s._v("Given a "),t("code",[s._v("Weather")]),s._v(" table, write a SQL query to find all dates' Ids with higher temperature compared to its previous (yesterday's) dates.")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+---------+------------+------------------+\n| Id(INT) | Date(DATE) | Temperature(INT) |\n+---------+------------+------------------+\n|       1 | 2015-01-01 |               10 |\n|       2 | 2015-01-02 |               25 |\n|       3 | 2015-01-03 |               20 |\n|       4 | 2015-01-04 |               30 |\n+---------+------------+------------------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("For example, return the following Ids for the above Weather table:")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+----+\n| Id |\n+----+\n|  2 |\n|  4 |\n+----+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"solutions-10"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions-10","aria-hidden":"true"}},[s._v("#")]),s._v(" Solutions")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    weather"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" "),t("span",{attrs:{class:"token string"}},[s._v("'Id'")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    weather\n        "),t("span",{attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v("\n    weather w "),t("span",{attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" DATEDIFF"),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("weather"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{attrs:{class:"token keyword"}},[s._v("date")]),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" w"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{attrs:{class:"token keyword"}},[s._v("date")]),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v("\n        "),t("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" weather"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Temperature "),t("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" w"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Temperature\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    t2"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Id\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    Weather t1"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Weather t2\n"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    t2"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{attrs:{class:"token keyword"}},[s._v("Date")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" DATE_ADD"),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("t1"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{attrs:{class:"token keyword"}},[s._v("Date")]),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("INTERVAL")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("day")]),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" t2"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Temperature "),t("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" t1"),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Temperature\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"_595-big-countries"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_595-big-countries","aria-hidden":"true"}},[s._v("#")]),s._v(" 595. Big Countries")]),s._v(" "),t("p",[s._v("There is a table "),t("code",[s._v("World")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+-----------------+------------+------------+--------------+---------------+\n| name            | continent  | area       | population   | gdp           |\n+-----------------+------------+------------+--------------+---------------+\n| Afghanistan     | Asia       | 652230     | 25500100     | 20343000      |\n| Albania         | Europe     | 28748      | 2831741      | 12960000      |\n| Algeria         | Africa     | 2381741    | 37100000     | 188681000     |\n| Andorra         | Europe     | 468        | 78115        | 3712000       |\n| Angola          | Africa     | 1246700    | 20609294     | 100990000     |\n+-----------------+------------+------------+--------------+---------------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("A country is big if it has an area of bigger than 3 million square km or a population of more than 25 million.\nWrite a SQL solution to output big countries' name, population and area.\nFor example, according to the above table, we should output:")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+--------------+-------------+--------------+\n| name         | population  | area         |\n+--------------+-------------+--------------+\n| Afghanistan  | 25500100    | 652230       |\n| Algeria      | 37100000    | 2381741      |\n+--------------+-------------+--------------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"solutions-11"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions-11","aria-hidden":"true"}},[s._v("#")]),s._v(" Solutions")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    name"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" population"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" area\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    world\n"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    area "),t("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("3000000")]),s._v("\n\n"),t("span",{attrs:{class:"token keyword"}},[s._v("UNION")]),s._v("\n\n"),t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    name"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" population"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" area\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    world\n"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    population "),t("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("25000000")]),s._v("\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    name"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" population"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" area\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    world\n"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    area "),t("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("3000000")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v("OR")]),s._v(" population "),t("span",{attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("25000000")]),s._v("\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"_620-not-boring-movies"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_620-not-boring-movies","aria-hidden":"true"}},[s._v("#")]),s._v(" 620. Not Boring Movies")]),s._v(" "),t("p",[s._v("X city opened a new cinema, many people would like to go to this cinema. The cinema also gives out a poster indicating the movies’ ratings and descriptions.\nPlease write a SQL query to output movies with an odd numbered ID and a description that is not 'boring'. Order the result by rating.")]),s._v(" "),t("p",[s._v("For example, table "),t("code",[s._v("cinema")]),s._v(":")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+---------+-----------+--------------+-----------+\n|   id    | movie     |  description |  rating   |\n+---------+-----------+--------------+-----------+\n|   1     | War       |   great 3D   |   8.9     |\n|   2     | Science   |   fiction    |   8.5     |\n|   3     | irish     |   boring     |   6.2     |\n|   4     | Ice song  |   Fantacy    |   8.6     |\n|   5     | House card|   Interesting|   9.1     |\n+---------+-----------+--------------+-----------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("For the example above, the output should be:")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+---------+-----------+--------------+-----------+\n|   id    | movie     |  description |  rating   |\n+---------+-----------+--------------+-----------+\n|   5     | House card|   Interesting|   9.1     |\n|   1     | War       |   great 3D   |   8.9     |\n+---------+-----------+--------------+-----------+\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"solutions-12"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions-12","aria-hidden":"true"}},[s._v("#")]),s._v(" Solutions")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" cinema\n"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" "),t("span",{attrs:{class:"token function"}},[s._v("mod")]),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("2")]),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v("AND")]),s._v(" description "),t("span",{attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{attrs:{class:"token string"}},[s._v("'boring'")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" RATING "),t("span",{attrs:{class:"token keyword"}},[s._v("DESC")]),s._v("\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"_627-swap-salary"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_627-swap-salary","aria-hidden":"true"}},[s._v("#")]),s._v(" 627. Swap Salary")]),s._v(" "),t("p",[s._v("Given a table "),t("code",[s._v("salary")]),s._v(", such as the one below, that has m=male and f=female values. Swap all f and m values (i.e., change all f values to m and vice versa) with a single update query and no intermediate temp table.\nFor example:")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("| id | name | sex | salary |\n|----|------|-----|--------|\n| 1  | A    | m   | 2500   |\n| 2  | B    | f   | 1500   |\n| 3  | C    | m   | 5500   |\n| 4  | D    | f   | 500    |\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("After running your query, the above salary table should have the following rows:")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("| id | name | sex | salary |\n|----|------|-----|--------|\n| 1  | A    | f   | 2500   |\n| 2  | B    | m   | 1500   |\n| 3  | C    | f   | 5500   |\n| 4  | D    | m   | 500    |\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"solutions-13"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions-13","aria-hidden":"true"}},[s._v("#")]),s._v(" Solutions")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("UPDATE")]),s._v(" salary\n"),t("span",{attrs:{class:"token keyword"}},[s._v("SET")]),s._v("\n    sex "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("CASE")]),s._v(" sex\n        "),t("span",{attrs:{class:"token keyword"}},[s._v("WHEN")]),s._v(" "),t("span",{attrs:{class:"token string"}},[s._v("'m'")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("THEN")]),s._v(" "),t("span",{attrs:{class:"token string"}},[s._v("'f'")]),s._v("\n        "),t("span",{attrs:{class:"token keyword"}},[s._v("ELSE")]),s._v(" "),t("span",{attrs:{class:"token string"}},[s._v("'m'")]),s._v("\n    "),t("span",{attrs:{class:"token keyword"}},[s._v("END")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"_596-classes-more-than-5-students"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_596-classes-more-than-5-students","aria-hidden":"true"}},[s._v("#")]),s._v(" 596. Classes More Than 5 Students")]),s._v(" "),t("p",[s._v("There is a table "),t("code",[s._v("courses")]),s._v(" with columns: "),t("strong",[s._v("student")]),s._v(" and "),t("strong",[s._v("class")])]),s._v(" "),t("p",[s._v("Please list out all classes which have more than or equal to 5 students.")]),s._v(" "),t("p",[s._v("For example, the table:")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+---------+------------+\n| student | class      |\n+---------+------------+\n| A       | Math       |\n| B       | English    |\n| C       | Math       |\n| D       | Biology    |\n| E       | Math       |\n| F       | Computer   |\n| G       | Math       |\n| H       | Math       |\n| I       | Math       |\n+---------+------------+\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[s._v("Should output:")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("+---------+\n| class   |\n+---------+\n| Math    |\n+---------+\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[t("strong",[s._v("Note:")]),s._v("\nThe students should not be counted duplicate in each course.")]),s._v(" "),t("h2",{attrs:{id:"solutions-14"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions-14","aria-hidden":"true"}},[s._v("#")]),s._v(" Solutions")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    class\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    "),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n        class"),t("span",{attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{attrs:{class:"token function"}},[s._v("COUNT")]),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{attrs:{class:"token keyword"}},[s._v("DISTINCT")]),s._v(" student"),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" num\n    "),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n        courses\n    "),t("span",{attrs:{class:"token keyword"}},[s._v("GROUP")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" class"),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" temp_table\n"),t("span",{attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    num "),t("span",{attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("5")]),s._v("\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    class\n"),t("span",{attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    courses\n"),t("span",{attrs:{class:"token keyword"}},[s._v("GROUP")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" class\n"),t("span",{attrs:{class:"token keyword"}},[s._v("HAVING")]),s._v(" "),t("span",{attrs:{class:"token function"}},[s._v("COUNT")]),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{attrs:{class:"token keyword"}},[s._v("DISTINCT")]),s._v(" student"),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),t("span",{attrs:{class:"token number"}},[s._v("5")]),s._v("\n"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])])])}],!1,null,null,null);e.options.__file="leetcode.md";a.default=e.exports}}]);